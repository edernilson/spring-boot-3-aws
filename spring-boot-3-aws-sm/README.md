# Spring Boot 3 AWS Secrets Manager Integration

A Spring Boot 3 application integration with AWS Secrets Manager, including Infrastructure as Code (IaC) using Terraform.

## Features

- Spring Boot 3.5.6 with Java 21
- AWS SDK v2 integration for Secrets Manager
- REST API for secret retrieval
- Terraform infrastructure automation
- Configurable AWS regions

## Architecture

This repository contains two separate projects:

### 1. Spring Boot Application
```
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   REST Client   │───▶│  Spring Boot App │───▶│ AWS Secrets Mgr │
└─────────────────┘    └──────────────────┘    └─────────────────┘
```

### 2. Terraform Infrastructure
```
┌──────────────────┐    ┌─────────────────┐
│   Terraform IaC  │───▶│ AWS Secrets Mgr │
└──────────────────┘    └─────────────────┘
```

The Terraform project provisions the AWS Secrets Manager resources that the Spring Boot application consumes.

## Prerequisites

- Java 21+
- Maven 3.6+
- Terraform 1.0+
- AWS CLI configured
- AWS credentials with Secrets Manager permissions

## Quick Start

### 1. Deploy Infrastructure

```bash
cd infra_iac
terraform init
terraform plan
terraform apply
```

### 2. Run Application

```bash
mvn spring-boot:run
```

### 3. Test API

```bash
curl http://localhost:8080/secretmanager/[SECRET_NAME generated by Terraform output]
```

## API Endpoints

| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/secretmanager/{secretName}` | Retrieve secret value |

## Configuration

### Terraform Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `aws_region` | AWS region | `us-east-1` |
| `secret_key` | Secret key name | `password` |
| `secret_value` | Secret value | `test` |

### Environment Variables

```bash
export TF_VAR_aws_region="us-west-2"
export TF_VAR_secret_value="your-secret-value"
```

## Project Structure

```
├── src/
│   └── main/
│       ├── java/com/edernilson/awssm/
│       │   └── AwsSMApplication.java
│       └── resources/
│           └── application.properties
├── infra_iac/
│   ├── main.tf
│   ├── variables.tf
│   ├── outputs.tf
│   └── .gitignore
├── pom.xml
└── README.md
```

## Security

- Terraform state files are excluded from version control
- Secret values marked as sensitive in Terraform
- AWS credentials managed via IAM roles/profiles

## Development

### Build

```bash
mvn clean compile
```

### Test

```bash
mvn test
```

### Package

```bash
mvn clean package
```

## Deployment

### Local Development

1. Deploy infrastructure: `terraform apply`
2. Start application: `mvn spring-boot:run`
3. Access: `http://localhost:8080`

### Production

- Use remote Terraform state (S3 + DynamoDB)
- Configure proper IAM roles
- Enable CloudWatch logging
- Use Application Load Balancer

## Cleanup

```bash
cd infra_iac
terraform destroy
```

## Contributing

1. Fork the repository
2. Create feature branch
3. Commit changes
4. Push to branch
5. Create Pull Request

## License

MIT License - see LICENSE file for details.

## Author

**Eder Nilson**
- Email: eder.nilson@gmail.com
- GitHub: [@edernilson](https://github.com/edernilson)